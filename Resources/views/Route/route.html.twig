{% extends "TisseoBoaBundle::base.html.twig" %}
{% import "TisseoBoaBundle::macros.html.twig" as render %}
{% block container %}

    <div class="row">
                <div class="col-md-12" role="main">
            {% block main_content %}
            <hr />
            <table class="table datatable table-hover dataTable no-footer" id="DataTables_Table_1" role="grid" aria-describedby="DataTables_Table_1_info">
                <tr>
                    <thead>
                    <th>Nom route</th><th>Départ</th><th>Arrivée</th><th>Commentaire</th><th>Sens</th><th>Editer</th>
                    </thead>
                </tr>
                {%  set serv = [] %}
                {% for route in routes %}
                  
                    <tr role="row" class="{{ (loop.index%2==0) ? "odd" : "even" }}">
                        <td id="{{ route.id }}">
                           {{ route.name }}
                        </td>
                        {% set size = (route.routeStops | length)  %}

                        {% set wayPoints = [] %}
                        {%  set indexo = loop.index %}

                        {%  set serv = serv|merge({(indexo-1):[]})  %}
                        {% for waypoint in route.routeStops %}

                            {%  if (waypoint.rank == 1) %}
                                {%  set serv = serv|merge({ (indexo-1):waypoint.waypoint.id})  %}
                            {% endif %}
                            {%  if (waypoint.rank == size) %}
                                {% set serv = serv|merge({ (indexo-1):waypoint.waypoint.id})  %}
                            {% endif %}
                        {%  endfor %}


                        {%  for stop in stops %}

                        {% endfor %}
                        <td> </td>
                        <td></td>
                        <td> {{ route.comment }}</td>
                        <td> {{ route.way }}</td>
                        <td id="idRoute">{{ route.id }}</td>
                        <td><button value="editer" class="editRoute btn btn-default"><a href="{{path('tisseo_boa_route_edit',{id:route.id})}}">Editer</a></button></td>
                        <td><button value="creer" class="editRoute btn btn-default"><a href="{{path('tisseo_boa_route_create',{idLine:route.lineVersion.id})}}">Créer</a></button></td>

                    </tr>

                {%  endfor %}

                {% endblock %}
            </table>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent }}


  {% javascripts '@TisseoBoaBundle/Resources/public/js/route.js' %}
    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', {'callback': 'fos.Router.setData'}) }}"></script>
    <script src="{{ asset_url }}"></script>

    {%  endjavascripts %}

{%  endblock %}
