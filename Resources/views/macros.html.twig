{% macro time_format(time) %}
    {% set hour = time//3600 %}
    {% set min = (time-hour*3600)/60 %}
    {% if hour|length < 2 %}
        {% set hour = "0" ~ hour %}
    {% endif %}
    {% if min|length < 2 %}
        {% set min = "0" ~ min %}
    {% endif %}
    {{ hour ~ ":" ~ min }}
{% endmacro %}

{% macro color_display(object) %}
    {% if object.name is defined %}
        <div class="line-number line-free" style="width:60px;height:25px;border: 1px solid #aaa;color:{{ object.html }}; background-color:{{ object.html }}"></div>
    {% endif %}
{% endmacro %}

{% macro stop_select(stops, select_id, select_class, all_label, all_value, select_name) %}
    <select id='{{ select_id }}' name='{{ select_name }}' class='{{ select_class }}'>
        <option value='{{ all_value }}'>{{ all_label }}</option>
    {% for Stop in stops %}
        {% if Stop.masterStop is empty %}
        <option value='{{ Stop.id }}'>{{ Stop.getStopLabel }}</option>
        {% endif %}
    {% endfor %}
    </select>
{% endmacro %}

{% macro route_header(route) %}
    <div class="form form-edit">
        <div class="col-md-12">
            <label>{{'trip.list.route.network'|trans({}, 'default')}} : </label>
            {{ route.lineVersion.line.lineDatasources[0].datasource.agency.name }} -
            <label>{{'trip.list.route.line'|trans({}, 'default')}} : </label>
            {{ route.lineVersion.line.number }} -
            <label>{{'trip.list.route.version'|trans({}, 'default')}} : </label>
            {{ route.lineVersion.version }} -
            <label>{{'trip.list.route.name'|trans({}, 'default')}} : </label>
            <a href="{{ path('tisseo_boa_route_list', {'lineVersionId': route.lineVersion.id }) }}">
                {{ route.name ~ ' (' ~ route.way ~ ')' }}
            </a>
        </div>
    </div>
{% endmacro %}

{% macro select(values, name, class_name) %}
    {% set class_attribute = "" %}
    {% if class_name is not empty %}
        {% set class_attribute = "class=" ~ class_name %}
    {% endif %}
    <select name="{{ name }}" {{ class_attribute }}>
        <option></option>
    {% for value in values %}
        <option value='{{ value }}'>{{ value }}</option>
    {% endfor %}
    </select>
{% endmacro %}

{% macro tableTrip(trips) %}
    <table class="table datatable table-hover dataTable no-footer" style="border: 1px solid black;">
        <thead>
            <th>{{ 'calendar_fh.trip.columns.name'|trans }}</th>
            <th>{{ 'calendar_fh.trip.columns.start'|trans }}</th>
            <th>{{ 'calendar_fh.trip.columns.service_type'|trans }}</th>
            <th>{{ 'calendar_fh.trip.columns.route'|trans }}</th>
            <th>{{ 'calendar_fh.trip.columns.start_end'|trans }}</th>
        </thead>
        <tbody>
        {% for trip in trips %}
            <tr>
                <td>
                    <a href="{{ path('tisseo_boa_trip_edit', {'tripId': trip.id}) }}">
                    {{ trip.name }}
                    </a>
                </td>
                <td>
                {% if trip.stopTimes %}
                    {{ _self.time_format(trip.stopTimes.first.arrivalTime) }}
                {% endif %}
                </td>
                <td>
                {% if trip.pattern %}
                    {{ trip.pattern.name }}
                {% endif %}
                </td>
                <td>
                    <a href="{{ path('tisseo_boa_route_edit', {'routeId': trip.route.id}) }}">
                    {{ trip.route.name }}
                    </a>
                </td>
                <td>
                {{ trip.route.routeStops.first.waypoint.stop.stopArea.nameLabel }}
                /
                {{ trip.route.routeStops.last.waypoint.stop.stopArea.nameLabel }}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endmacro %}

{% macro TripCalendarInputs(grid_index, trip_calendar) %}
    {% if trip_calendar is not empty %}
        {% for day in ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'] %}
            {% if attribute(trip_calendar, day) %}
                {% set checked = "checked" %}
            {% else %}
                {% set checked = "" %}
            {% endif %}

            <input type='checkbox' class="circulation-day" name="grid[{{ grid_index }}][{{ day }}]" {{ checked }}  >
        {% endfor %}
    {% else %}
        {% for day in ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'] %}
            <input type='checkbox' class="circulation-day" name="grid[{{ grid_index }}][{{ day }}]">
        {% endfor %}
    {% endif %}
{% endmacro %}
