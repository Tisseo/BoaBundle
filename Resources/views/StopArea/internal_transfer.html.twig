{% extends "::modal.html.twig" %}

{% form_theme form 'TisseoBoaBundle:Form:fields.html.twig' %}

{% block modal_title %}
    {{ title|trans({}, 'default') ~ " " ~ stopAreaLabel }}
{% endblock %}

{% block open_form %}
    {{ form_start(form) }}
{% endblock %}

{% block modal_body %}
    {{ form_errors(form) }}
	{{ form_widget(form._token) }}
	
	<div class="row">
		<div class = "col-md-4"> {{ form_label(form.transferDuration) }} </div> 
		<div class = "col-md-1"> {{ form_widget(form.transferDuration) }} </div> 
	</div>
	
	<div>
		<div class="stop_table_header">{{ 'stop_area.labels.internal_transfert' | trans }}</div>
		<table 
			id='transfer_table'
			class="table table-hover dataTable no-footer"
		>
		<thead>
			<th>{{ 'stop_area.transfer.columns.startStop' | trans }}</th>
			<th>{{ 'stop_area.transfer.columns.endStop' | trans }}</th>
			<th>{{ 'stop_area.transfer.columns.duration' | trans }}</th>
			<th>{{ 'stop_area.transfer.columns.distance' | trans }}</th>
			<th>{{ 'stop_area.transfer.columns.longName' | trans }}</th>
			<th>{{ 'stop_area.transfer.columns.theGeom' | trans }}</th>
		</thead>
		<tbody>
			{% set index = 0 %}
			{%  for startStop in stopArea.stops %}
				{%  if startStop.masterStop is empty %}
					{%  for endStop in stopArea.stops %}
						{%  if endStop.masterStop is empty %}
							<tr>
							<td>{{ startStop.stopHistories[0].shortName ~ " - " ~ startStop.stopDatasources[0].datasource.agency.name ~ " (" ~ startStop.stopDatasources[0].code  ~ ") " }}</td>	
							<td>{{ endStop.stopHistories[0].shortName ~ " - " ~ endStop.stopDatasources[0].datasource.agency.name ~ " (" ~ endStop.stopDatasources[0].code  ~ ") " }}</td>	
							<td><input type='text' id="form_transfer_{{ index }}_duration" name="form[transfer][{{ index }}][duration]" class="form-control" ></td>	
							<td><input type='text' id="form_transfer_{{ index }}_distance" name="form[transfer][{{ index }}][distance]" class="form-control"></td>	
							<td><input type='text' id="form_transfer_{{ index }}_longName" name="form[transfer][{{ index }}][longName]" class="form-control"></td>	
							<td><input type='text' id="form_transfer_{{ index }}_theGeom" name="form[transfer][{{ index }}][theGeom]" class="form-control"></td>	
							</tr>
							{% set index = index + 1 %}
						{%  endif %}
					{%  endfor %}
				{%  endif %}
			{%  endfor %}
		</tbody>
		</table>
	</div>
{% endblock %}

{% block modal_actions %}
    <button type="submit" class="btn btn-success">
        <span class="glyphicon glyphicon-pencil"></span>{{ 'global.save'|trans }}
    </button>
    {{ form_end(form, { 'render_rest': false}) }}
	<script>   
		require(['jquery'], function($) {
			$('.modal-dialog').css('width', '1300px');
		});
    </script>		
{% endblock %}
