{% extends "::modal.html.twig" %}

{% form_theme form 'TisseoBoaBundle:Form:fields.html.twig' %}

{% block modal_title %}
    {{ title|trans({}, 'default') }}
{% endblock %}

{% block open_form %}
    {{ form_start(form) }}
{% endblock %}

{% block modal_body %}
    {{ form_errors(form) }}
    {{ form_widget(form._token) }}

    <div>
        <div class="stop_table_header">Alias de la zone "{{ stopAreaLabel }}"</div>
        <table
            id='alias_table'
            class="table table-hover dataTable no-footer"
            data-prototype="{% filter escape %}{{ form_widget(form.alias.vars.prototype['name']) }} {% endfilter %}"
        >
        <thead>
            <th>Nom</th>
            <th>Action</th>
        </thead>
        <tbody>
        {%  for alias in form.alias %}
        <tr>
            <td>
                {{ form_widget(alias.name) }}
            </td>
            <td>
                <a class="btn btn-default" href="#"><span class="glyphicon glyphicon-remove"></span>{{'global.delete'|trans({}, 'messages')}}</a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
        </table>
    </div>
    <div class="row">
        <div class="col-md-3">
            <a class="btn btn-default" id="add_element" href="#"><span class="glyphicon glyphicon-plus"></span>{{'global.add'|trans({}, 'messages')}}</a>
        </div>
    </div>
{% endblock %}

{% block modal_actions %}
    <button type="submit" class="btn btn-success">
        <span class="glyphicon glyphicon-pencil"></span>{{ 'tisseo.global.save'|trans }}
    </button>
    {{ form_end(form, { 'render_rest': false}) }}
    <script>
           require(['boa/stop/utils'], function(utils) {
            $('#add_element').click(function(event) {
                utils.add_alias('#alias_table');
            });
        });

        $('#alias_table').on('click', "a", function(event) {
            event.preventDefault();
            if ($(this).text() === "{{'global.delete'|trans({}, 'messages')}}") {
                $(this).closest("tr").remove();
            }
        });

    </script>
{% endblock %}
